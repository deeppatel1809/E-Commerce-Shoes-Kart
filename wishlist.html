<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.9.1/font/bootstrap-icons.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="css\shoes.css">
    <link rel="stylesheet" href="css\account.css">
    <title>Wishlist</title>
</head>
<body>
    <header id="header">
    </header>
    <nav id="navbar">
    </nav>
    <div id="account-sidebar">
    </div>
    <div id="wishlist-container">
    </div>
    <footer id="footer">
    </footer>
    <script src="js\shoes.js"></script>
    <script src="js\account.js"></script>
    <script src="js\data.js"></script>
    <script>
        window.onload = function()
        {
            showHeader();
            showNavbar();
            showFooter();

            const products = JSON.parse(localStorage.getItem('products')) || [];
            const users = JSON.parse(localStorage.getItem('users')) || [];
            const currentUser = JSON.parse(localStorage.getItem('loginUser'));
            let user;

            if (currentUser)
            {
                user = users.find(item => item.login.email === currentUser.email || item.login.phone === currentUser.phone);
                
                if (user.wishlist.length === 0)
                {
                    emptyWishlist();
                }
                else
                {
                    const wishlistContainer = document.getElementById('wishlist-container');
                    wishlistContainer.classList.add('container','my-4');
                    wishlistContainer.innerHTML = `
                        <div class="row">
                            <div class="col-sm-12 col-md-8">
                                <h2 class="my-4 fw-bolder">MY WISHLIST</h2>
                                <div class="mb-4" id="wishlist">
                                </div>
                            </div>
                        </div>
                        <div class="modal modal-xl" id="productModal" data-bs-backdrop="static">
                            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <img src="" class="card-img-left img-fluid" alt="" id="img">
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="row mt-2">
                                                    <div class="col">
                                                        <h2 id="name" class="fw-bold h2"></h2>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col">
                                                        <p id="desc"></p>
                                                    </div>
                                                </div>
                                                <div class="row mb-2">
                                                    <div class="col mb-0">
                                                        <div class="d-flex flex-row">
                                                            <div>
                                                                <h5 id="offer-price" class="fw-bold mb-0 h5"></h5>
                                                            </div>
                                                            <div>
                                                                <p id="price" class="mt-1 mb-0" style="font-size: 14px;"></p>
                                                            </div>
                                                        </div>
                                                        <p>(inclusive of all taxes)</p>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col">
                                                        <p id="category"></p>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col">
                                                        <p id="material"></p>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col">
                                                        <p id="brand"></p>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col">
                                                        <p id="rating"></p>
                                                    </div>
                                                </div>
                                                <div class="row-12 mb-2">
                                                    <div class="col">
                                                        <p class="fw-bold">Sizes</p>
                                                    </div>
                                                </div>
                                                <div class="row mb-2">
                                                    <div class="col-4 col-xl-2 m-0 p-0">
                                                        <div class="form-check form-check-inline">
                                                            <input class="btn-check" type="radio" value="6" name="msize" id="1">
                                                            <label class="btn btn-outline-dark mb-3" for="1">6</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-4 col-xl-2 m-0 p-0">
                                                        <div class="form-check form-check-inline">
                                                            <input class="btn-check" type="radio" value="7" name="msize" id="2">
                                                            <label class="btn btn-outline-dark mb-3" for="2">7</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-4 col-xl-2 m-0 p-0">
                                                        <div class="form-check form-check-inline">
                                                            <input class="btn-check" type="radio" value="8" name="msize" id="3">
                                                            <label class="btn btn-outline-dark mb-3" for="3">8</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-4 col-xl-2 m-0 p-0">
                                                        <div class="form-check form-check-inline">
                                                            <input class="btn-check" type="radio" value="9" name="msize" id="4">
                                                            <label class="btn btn-outline-dark mb-3" for="4">9</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-4 col-xl-2 m-0 p-0">
                                                        <div class="form-check form-check-inline">
                                                            <input class="btn-check" type="radio" value="10" name="msize" id="5">
                                                            <label class="btn btn-outline-dark mb-3" for="5">10</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-4 col-xl-2 m-0 p-0">
                                                        <div class="form-check form-check-inline">
                                                            <input class="btn-check" type="radio" value="11" name="msize" id="6">
                                                            <label class="btn btn-outline-dark mb-3" for="6">11</label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row mb-4">
                                                    <div class="col">
                                                        <a class="text-black" href="shoeSize.html">Size guide</a>
                                                    </div>
                                                </div>
                                                <div class="row mb-2">
                                                    <div class="col d-grid text-center">
                                                        <button id="cart-button" class="btn btn-dark" onclick="cart(this)">Add To Cart</button>
                                                    </div>
                                                </div>
                                                <div class="row mb-2">
                                                    <div class="col d-grid text-center">
                                                        <button id="wishlist-button" class="btn btn-dark" onclick="wishlist(this)">Add To Wishlist</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    const wishlist = document.getElementById('wishlist');

                    let rowContainer = document.createElement('div');
                    rowContainer.classList.add('row');

                    user.wishlist.forEach((item) => {

                        const product = products.find(product => product.pid === item.pid);
                        const shoeItem = document.createElement('div');
                        shoeItem.classList.add('col-12');

                        shoeItem.innerHTML = `
                            <a href="#productModal" class="text-decoration-none" data-bs-toggle="modal" onclick=productModal(this)>
                                <div id="${item.pid}" class="card m-1 border border-sm-0">
                                    <div class="card-body p-0">
                                        <div class="row">
                                            <div class="col-4">
                                                <img src="${product.img}" class="card-img img-fluid rounded-0 rounded-start" alt="${item.pid}" id="product-img">
                                            </div>
                                            <div class="col-8">
                                                <div class="row">
                                                    <div class="col pt-3">
                                                        <p class="card-title fw-bold">${product.name}</p>
                                                        <p class="card-text text-danger mb-0"><i class="bi bi-currency-rupee"></i>${product.offerPrice}</p>
                                                        <p class="card-text mb-0" style="font-size: 14px;"><del><i class="bi bi-currency-rupee"></i>${product.price}</del></p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        `;
                        rowContainer.appendChild(shoeItem);
                    });

                    wishlist.appendChild(rowContainer);
                }
            }
            else
            {
                const wishlistContainer = document.getElementById('wishlist-container');
                wishlistContainer.classList.add('container','my-4');
                wishlistContainer.innerHTML = `
                    <div class="row offset-sm-1 offset-lg-2">
                        <div class="col-sm-11 col-lg-10">
                            <h2 class="mt-4 fw-bolder">YOUR WISHLIST</h2>
                            <p class="mt-4">Nothing to see. Log in to see your wishlist.</p><button type="button" class="btn btn-dark my-4" onclick="window.location.href = 'login.html';">LOGIN</button>
                        </div>
                    </div>
                `;
            }
        }

        function emptyWishlist()
        {
            const wishlistContainer = document.getElementById('wishlist-container');
            wishlistContainer.classList.add('container','my-4');
            wishlistContainer.innerHTML = `
                <div class="row offset-sm-1 offset-lg-2">
                    <div class="col-sm-11 col-lg-10">
                        <h2 class="mt-4 fw-bolder">YOUR WISHLIST IS EMPTY</h2>
                        <p class="mt-4">Once you add something to your wishlist - it will appear here. To add click on shop now.</p><button type="button" class="btn btn-dark my-5" onclick="window.location.href = 'index.html';">SHOP NOW <i class="bi bi-arrow-right"></i></button>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>